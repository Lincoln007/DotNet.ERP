@model CommodityPromotion
@{
    ViewBag.Title = Pharos.Sys.SysConstPool.Page_Title;
    Layout = "~/Views/Shared/_FormLayout.cshtml";
}
<div class="default-form">
    @using (Html.BeginForm())
    {
        <div class="content">
            <div class="formbox">
                <table class="table-form" height="117px">
                    <tr>
                        <td class="name">活动有效期：</td>
                        <td class="input">
                            <table>
                                <tr>
                                    <td>@Html.DisplayTextFor(o => o.StartDate, "{0:yyyy-MM-dd}")</td>
                                    <td style="padding-left:7px;padding-right:7px;line-height:28px;">至</td>
                                    <td>@Html.DisplayTextFor(o => o.EndDate, "{0:yyyy-MM-dd}")</td>
                                    <td style="padding-left:10px;">适用客户：</td>
                                    <td>@Html.RadioButtonListFor(o => o.CustomerObj, ViewBag.customers as List<SelectListItem>)</td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td class="name">活动时效：</td>
                        <td class="input times">
                            <table>
                                <tr>
                                    <td>@Html.RadioButtonListFor(o => o.Timeliness, new List<SelectListItem>() { new SelectListItem() { Text = "不限", Value = "0", Selected = true }, new SelectListItem() { Text = "指定每天时效", Value = "1" } })</td>
                                    <td id="tdtimes">@Html.TimeBoxList((List<string>)ViewBag.times, "Times")</td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td class="name">适用门店：</td>
                        <td class="input choose">@Html.CheckBoxListFor(o => o.StoreId, ViewBag.shops as List<SelectListItem>, new { data_options = "", @class = "easyui-validatebox", id = "store" })</td>
                    </tr>
                </table>
            </div><br />
            <div id="tt1" class="easyui-tabs" style="height:auto;">
                <div title="促销商品" style="padding:10px;">
                    <table class="easyui-datagrid" id="grid2"
                           data-options="url:'@Url.Action("LoadDetailList")',queryParams:{zhekouId:'@Model.Id',type:1},showFooter:false,border:true,rownumbers:true,fit:false,fitColumns:true,pagination:false,singleSelect: true,onLoadError:loadError,idField:'Id'">
                        <thead>
                            <tr>
                                <th data-options="field:'ProductCode',editor:{type:'textbox',options:{disabled:true}}" width="120">货号</th>
                                <th data-options="field:'Barcode'" width="150">条码</th>
                                <th data-options="field:'Title',editor:{type:'textbox',options:{disabled:true}}" width="150">品名</th>
                                <th data-options="field:'CategoryTitle',editor:{type:'textbox',options:{disabled:true}}" width="80">品类</th>
                                <th data-options="field:'SubUnit',editor:{type:'textbox',options:{disabled:true}}" width="60">单位</th>
                                <th data-options="field:'SysPrice',editor:{type:'textbox',options:{disabled:true}}" width="80">系统售价</th>
                                <th data-options="field:'StockNums',editor:{type:'textbox',options:{disabled:true}}" width="120">库存</th>
                                <th data-options="field:'MinPurchaseNum',editor:{type:'numberbox',options:{disabled:false,required:true,min:1}}" width="60">起购量</th>
                                <th data-options="field:'Detail'" width="200">赠送商品</th>
                                <th data-options="field:'RestrictionBuyNum',editor:{type:'numberbox',options:{disabled:false,required:true,min:0}}" width="80">限购次数</th>
                            </tr>
                        </thead>
                    </table>
                </div>
                <div title="促销系列" style="padding:10px;">
                    <table class="easyui-datagrid" id="grid3"
                           data-options="url:'@Url.Action("LoadDetailList")',queryParams:{zhekouId:'@Model.Id',type:2},showFooter:false,border:true,rownumbers:true,fit:false,fitColumns:true,pagination:false,singleSelect: true,onLoadSuccess:function(){},onLoadError:loadError,idField:'Id'">
                        <thead>
                            <tr>
                                <th data-options="field:'Id',hidden:true,editor:{type:'textbox'}" width="120">ID</th>
                                <th data-options="field:'StrId',hidden:true,editor:{type:'textbox'}" width="120">ID</th>
                                <th data-options="field:'CategorySN',hidden:true,editor:{type:'textbox'}" width="120">类别</th>
                                <th data-options="field:'BrandSN',hidden:true,editor:{type:'textbox'}" width="120">品牌ID</th>
                                <th data-options="field:'BigCategoryTitle'" width="150">大类</th>
                                <th data-options="field:'MidCategoryTitle'" width="150">中类</th>
                                <th data-options="field:'SubCategoryTitle'" width="150">子类</th>
                                <th data-options="field:'BrandTitle'" width="120">品牌</th>
                                <th data-options="field:'StockNums'" width="120">库存</th>
                                <th data-options="field:'MinPurchaseNum'" width="60">起购量</th>
                                <th data-options="field:'Detail'" width="200">赠送商品</th>
                                <th data-options="field:'RestrictionBuyNum'" width="80">限购次数</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
            <p style="margin-top:30px;">
                说明：<br />
                1）录入货号或条码后自动填充相关商品信息；<br />
                2）限购次数为0，则表示无限制，直至商品售完或活动到期为止；<br />
                3）限购次数大于0，则表示每天限多少个购买订单。<br />
            </p>
        </div>
    }
</div>

<script type="text/javascript">
    $(function () {
        if ($("[name='Timeliness']").html() == "不限") {
            $("#tdtimes").hide();
        }
    });
</script>