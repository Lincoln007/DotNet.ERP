<Window x:Class="Pharos.POS.Retailing.ChildPages.Changing"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:local="clr-namespace:Pharos.POS.Retailing.Converters"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"   Style="{DynamicResource SkinWindowStyle}"
        Height="650" Width="1000" WindowStyle="None"   Background="{x:Null}"  WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"   WindowState="Normal" Icon="..\Images\change.png" Title="退换货"
        AllowsTransparency="True" 
         BorderBrush="Transparent"  FontFamily="/Pharos.POS.Retailing;component/Fonts/#Microsoft YaHei" 
        Name="mainWindow">
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="..\Styles\ChangingStyle.xaml"></ResourceDictionary>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>

    <Grid>
        <TabControl BorderBrush="Gainsboro" BorderThickness="1" >
            <TabControl.Resources>
                <Style TargetType="TabItem">
                    <Setter Property="Foreground" Value="White"></Setter>
                    <Setter Property="BorderThickness" Value="0"></Setter>
                    <Setter Property="Padding" Value="30,5"></Setter>
                    <Style.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Background" Value="#ffffff" />
                            <Setter Property="BorderThickness" Value="1,1,1,0" />
                        </Trigger>
                        <Trigger Property="IsSelected" Value="False">
                            <Setter Property="Background" Value="#EDEDED" />
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </TabControl.Resources>


            <TabItem Name="changeItem" Header="换货"  Foreground="#5A5654" FontSize="16">
                <Grid Grid.Row="1" Name="changingGrid">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="139*"/>
                        <ColumnDefinition Width="855*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"></RowDefinition>
                        <RowDefinition Height="50"></RowDefinition>
                        <RowDefinition Height="80"></RowDefinition>
                    </Grid.RowDefinitions>

                    <Border Grid.Column="0" Grid.Row="0" BorderBrush="#808080" BorderThickness="1" Background="#E0E3E8" CornerRadius="10,10,5,5" Margin="10" Grid.ColumnSpan="2">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"></RowDefinition>
                            </Grid.RowDefinitions>
                            <DataGrid ItemsSource="{Binding OldProducts}" TabIndex="14" Margin="0" Foreground="#4B4B4B" BorderBrush="#5C5753" BorderThickness="0" VerticalGridLinesBrush="Transparent" HorizontalGridLinesBrush="#D6DBE9" CanUserSortColumns="False" CanUserDeleteRows="True" CanUserAddRows="False" CanUserReorderColumns="False" HeadersVisibility="Column"  AutoGenerateColumns="False" x:Name="DataGridGoods">
                                <DataGrid.ColumnHeaderStyle>
                                    <Style  BasedOn="{StaticResource BaseDataGridColumnHeader}" TargetType="DataGridColumnHeader">
                                        <Setter Property="Background" Value="#C8C8C8"></Setter>
                                        <Setter Property="FontSize" Value="14"></Setter>
                                    </Style>
                                </DataGrid.ColumnHeaderStyle>
                                <DataGrid.RowStyle>
                                    <Style  TargetType="DataGridRow">
                                        <Setter Property="Background" Value="#FFFFFF" />
                                        <Setter Property="Foreground" Value="#E0E3E8" />
                                        <Setter Property="MinHeight" Value="60"></Setter>
                                        <Setter Property="Padding" Value="0,20,20,0"></Setter>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#FFFDEE"/>
                                            </Trigger>

                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter Property="Background" Value="#FFF29D"/>
                                            </Trigger>
                                            <DataTrigger  Binding="{Binding IsChange}" Value="False">
                                                <Setter Property="Foreground" Value="#E0E3E8"></Setter>
                                            </DataTrigger>
                                            <DataTrigger  Binding="{Binding IsChange}" Value="True">
                                                <Setter Property="Foreground" Value="#000000"></Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGrid.RowStyle>
                                <DataGrid.Columns>
                                    <DataGridTextColumn CanUserSort="False" Width="150" Header="条码" IsReadOnly="True" Binding="{Binding Barcode,Mode=TwoWay}"></DataGridTextColumn>
                                    <DataGridTextColumn Width="250"  CanUserSort="False" Header="品名" IsReadOnly="True" Binding="{Binding Title,Mode=TwoWay}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="TextWrapping" Value="Wrap"/>
                                                <Setter Property="Height" Value="auto"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTemplateColumn CanUserSort="False" Width="*" Header="数量" IsReadOnly="True"  >
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Visibility="{Binding NotChangeVisibility,Mode=TwoWay}" Text="{Binding Number,Mode=TwoWay}"></TextBlock>
                                                    <TextBox Width="80"  Visibility="{Binding ChangeVisibility,Mode=TwoWay}"  Text="{Binding ChangeNumber,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" ></TextBox>
                                                </StackPanel>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTextColumn CanUserSort="False" Width="*" Header="当前售价" IsReadOnly="True" Binding="{Binding SysPrice,Mode=TwoWay,StringFormat='{}{0:C}'}" ></DataGridTextColumn>
                                    <DataGridTextColumn CanUserSort="False" Width="*" Header="售价" IsReadOnly="True" Binding="{Binding SalePrice,Mode=TwoWay,StringFormat='{}{0:C}'}" ></DataGridTextColumn>
                                    <DataGridTextColumn CanUserSort="False" Width="*" Header="小计" IsReadOnly="True" Binding="{Binding Total,Mode=TwoWay,StringFormat='{}{0:C}'}" ></DataGridTextColumn>
                                    <DataGridTemplateColumn CanUserSort="False" IsReadOnly="True" MinWidth="110" Width="*" Header="操作">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal">
                                                    <Button Style="{StaticResource BtnBase}" Command="{Binding Change}" BorderBrush="#A0B888" Width="50" Foreground="#A0B888" Height="30"  BorderThickness="1" FontSize="12" Background="#FFFFFF" Grid.Column="1">换货</Button>
                                                    <Button Style="{StaticResource BtnBase}" Command="{Binding Cancel}" BorderBrush="#400020" Width="50" Foreground="#A0B888" Height="30"  BorderThickness="1" FontSize="12" Background="#FFFFFF" Grid.Column="1">取消</Button>
                                                </StackPanel>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Border>

                    <Grid Grid.Row="1" Grid.ColumnSpan="2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="10"></ColumnDefinition>
                            <ColumnDefinition Width="250"></ColumnDefinition>
                            <ColumnDefinition Width="250"></ColumnDefinition>
                            <ColumnDefinition Width="250"></ColumnDefinition>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="3" Orientation="Horizontal">
                            <TextBlock>顾客补价：</TextBlock>
                            <TextBox TabIndex="5" Style="{StaticResource txtBaseInput}" Text="{Binding Premium,StringFormat='{}{0:C}'}" Height="35" HorizontalContentAlignment="Left" VerticalContentAlignment="Center"></TextBox>
                        </StackPanel>
                        <StackPanel Grid.Column="2" Orientation="Horizontal">
                            <TextBlock>换货理由：</TextBlock>
                            <ComboBox TabIndex="3"  Height="35" ItemsSource="{Binding ChangingSelectItem}" DisplayMemberPath="Title" SelectedValuePath="DicSN" SelectedValue="{Binding Reason}"></ComboBox>
                        </StackPanel>

                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                            <TextBlock>流水号:</TextBlock>
                            <TextBox TabIndex="1" Height="35" HorizontalContentAlignment="Left" VerticalContentAlignment="Center" Text="{Binding OrderId}" Style="{StaticResource txtBaseInput}"/>
                        </StackPanel>

                    </Grid>

                    <Border Grid.Row="2" BorderBrush="#AFB3B7" BorderThickness="0,1,0,0" Grid.ColumnSpan="2">
                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Button TabIndex="6" Style="{StaticResource BtnOkStyle}" Command="{Binding Save}" CommandParameter="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}">确定</Button>
                        </StackPanel>
                    </Border>
                </Grid>

            </TabItem>

            <TabItem Name="refundItem" Header="退货"  Foreground="#5A5654" FontSize="16">
                <Grid Grid.Row="1" Name="refundGird">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"></RowDefinition>
                        <RowDefinition Height="0"></RowDefinition>
                        <RowDefinition Height="80"></RowDefinition>
                        <RowDefinition Height="80"></RowDefinition>
                    </Grid.RowDefinitions>

                    <Border Grid.Column="0" BorderBrush="#808080" BorderThickness="1" Grid.Row="0" Background="#E0E3E8" CornerRadius="10,10,5,5" Margin="10">
                        <DataGrid ItemsSource="{Binding OldProducts}" TabIndex="14" Margin="0" Foreground="#4B4B4B" BorderBrush="#5C5753" BorderThickness="0" VerticalGridLinesBrush="Transparent" HorizontalGridLinesBrush="#D6DBE9" CanUserSortColumns="False" CanUserDeleteRows="True" CanUserAddRows="False" CanUserReorderColumns="False" HeadersVisibility="Column"  AutoGenerateColumns="False" x:Name="rDataGridGoods">
                            <DataGrid.ColumnHeaderStyle>
                                <Style  BasedOn="{StaticResource BaseDataGridColumnHeader}" TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="#C8C8C8"></Setter>
                                    <Setter Property="FontSize" Value="14"></Setter>

                                </Style>
                            </DataGrid.ColumnHeaderStyle>
                            <DataGrid.Columns>
                                <DataGridTextColumn CanUserSort="False" Width="150" Header="条码" IsReadOnly="True" Binding="{Binding Barcode,Mode=TwoWay}"></DataGridTextColumn>
                                <DataGridTextColumn Width="250"  CanUserSort="False" Header="品名" IsReadOnly="True" Binding="{Binding Title,Mode=TwoWay}">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="TextWrapping" Value="Wrap"/>
                                            <Setter Property="Height" Value="auto"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTemplateColumn CanUserSort="False" Width="*" Header="数量" IsReadOnly="True"  >
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Visibility="{Binding NotChangeVisibility,Mode=TwoWay}" Text="{Binding Number,Mode=TwoWay}"></TextBlock>
                                                <TextBox Width="80" Visibility="{Binding ChangeVisibility,Mode=TwoWay}"  Text="{Binding ChangeNumber,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" ></TextBox>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn CanUserSort="False" Width="*" Header="售价" IsReadOnly="True" Binding="{Binding SalePrice,Mode=TwoWay,StringFormat='{}{0:C}'}" ></DataGridTextColumn>
                                <DataGridTextColumn CanUserSort="False" Width="*" Header="小计" IsReadOnly="True" Binding="{Binding Total,Mode=TwoWay,StringFormat='{}{0:C}'}" ></DataGridTextColumn>
                                <DataGridTemplateColumn CanUserSort="False" IsReadOnly="True" MinWidth="110" Width="*" Header="操作">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Button Style="{StaticResource BtnBase}" Command="{Binding Change}" BorderBrush="#A0B888" Width="50" Foreground="#A0B888" Height="30"  BorderThickness="1" FontSize="12" Background="#FFFFFF" Grid.Column="1">退货</Button>
                                                <Button Style="{StaticResource BtnBase}" Command="{Binding Cancel}" BorderBrush="#400020" Width="50" Foreground="#A0B888" Height="30"  BorderThickness="1" FontSize="12" Background="#FFFFFF" Grid.Column="1">取消</Button>

                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>
                    <Grid Grid.Row="2" Grid.ColumnSpan="2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="10"></ColumnDefinition>
                            <ColumnDefinition Width="250"></ColumnDefinition>
                            <ColumnDefinition Width="250"></ColumnDefinition>
                            <ColumnDefinition Width="250"></ColumnDefinition>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="3" Orientation="Horizontal">
                            <TextBlock>退还金额:</TextBlock>
                            <TextBox TabIndex="4" Text="{Binding Premium,StringFormat='{}{0:C}'}" Height="35" Width="150" HorizontalContentAlignment="Left" VerticalContentAlignment="Center"></TextBox>
                        </StackPanel>
                        <StackPanel Grid.Column="2" Orientation="Horizontal">
                            <TextBlock>退货理由：</TextBlock>
                            <ComboBox TabIndex="3" Height="35" ItemsSource="{Binding ChangingSelectItem}" DisplayMemberPath="Title" SelectedValuePath="DicSN" SelectedValue="{Binding Reason}"></ComboBox>
                        </StackPanel>

                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                            <TextBlock>流水号:</TextBlock>
                            <TextBox TabIndex="1" Height="35" HorizontalContentAlignment="Left" VerticalContentAlignment="Center" Text="{Binding OrderId}" Style="{StaticResource txtBaseInput}"/>
                        </StackPanel>

                    </Grid>

                    <Border Grid.Row="3" BorderBrush="#AFB3B7" BorderThickness="0,1,0,0">
                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Button TabIndex="5" Style="{StaticResource BtnOkStyle}" Command="{Binding Save}" CommandParameter="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}">确定</Button>
                        </StackPanel>
                    </Border>
                </Grid>

            </TabItem>

            <TabItem Name="RemoveItem" Header="整单退货"  Foreground="#5A5654" FontSize="16">
                <Grid Grid.Row="1" x:Name="billGird">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"></RowDefinition>
                        <RowDefinition Height="0"></RowDefinition>
                        <RowDefinition Height="80"></RowDefinition>
                        <RowDefinition Height="80"></RowDefinition>
                    </Grid.RowDefinitions>

                    <Border Grid.Column="0" BorderBrush="#808080" BorderThickness="1" Grid.Row="0" Background="#E0E3E8" CornerRadius="10,10,5,5" Margin="10">
                        <DataGrid ItemsSource="{Binding OldProducts}" TabIndex="14" Margin="0" Foreground="#4B4B4B" BorderBrush="#5C5753" BorderThickness="0" VerticalGridLinesBrush="Transparent" HorizontalGridLinesBrush="#D6DBE9" CanUserSortColumns="False" CanUserDeleteRows="True" CanUserAddRows="False" CanUserReorderColumns="False" HeadersVisibility="Column"  AutoGenerateColumns="False">
                            <DataGrid.ColumnHeaderStyle>
                                <Style  BasedOn="{StaticResource BaseDataGridColumnHeader}" TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="#C8C8C8"></Setter>
                                    <Setter Property="FontSize" Value="14"></Setter>

                                </Style>
                            </DataGrid.ColumnHeaderStyle>
                            <DataGrid.Columns>
                                <DataGridTextColumn CanUserSort="False" Width="150" Header="条码" IsReadOnly="True" Binding="{Binding Barcode,Mode=TwoWay}"></DataGridTextColumn>
                                <DataGridTextColumn Width="250"  CanUserSort="False" Header="品名" IsReadOnly="True" Binding="{Binding Title,Mode=TwoWay}">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="TextWrapping" Value="Wrap"/>
                                            <Setter Property="Height" Value="auto"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTemplateColumn CanUserSort="False" Width="*" Header="数量" IsReadOnly="True"  >
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock  Text="{Binding Number,Mode=TwoWay}"></TextBlock>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn CanUserSort="False" Width="*" Header="售价" IsReadOnly="True" Binding="{Binding SalePrice,Mode=TwoWay,StringFormat='{}{0:C}'}" ></DataGridTextColumn>
                                <DataGridTextColumn CanUserSort="False" Width="*" Header="小计" IsReadOnly="True" Binding="{Binding Total,Mode=TwoWay,StringFormat='{}{0:C}'}" ></DataGridTextColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>
                    <Grid Grid.Row="2" Grid.ColumnSpan="2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="10"></ColumnDefinition>
                            <ColumnDefinition Width="250"></ColumnDefinition>
                            <ColumnDefinition Width="250"></ColumnDefinition>
                            <ColumnDefinition Width="250"></ColumnDefinition>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="3" Orientation="Horizontal">
                            <TextBlock>退还金额:</TextBlock>
                            <TextBox TabIndex="4" Text="{Binding Premium,StringFormat='{}{0:C}'}" Height="35" Width="150" HorizontalContentAlignment="Left" VerticalContentAlignment="Center"></TextBox>
                        </StackPanel>
                        <StackPanel Grid.Column="2" Orientation="Horizontal">
                            <TextBlock>退货理由：</TextBlock>
                            <ComboBox TabIndex="3" Height="35" ItemsSource="{Binding ChangingSelectItem}" DisplayMemberPath="Title" SelectedValuePath="DicSN" SelectedValue="{Binding Reason}"></ComboBox>
                        </StackPanel>

                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                            <TextBlock>流水号:</TextBlock>
                            <TextBox TabIndex="1" Height="35" HorizontalContentAlignment="Left" VerticalContentAlignment="Center" Text="{Binding OrderId}" Style="{StaticResource txtBaseInput}"/>
                        </StackPanel>

                    </Grid>

                    <Border Grid.Row="3" BorderBrush="#AFB3B7" BorderThickness="0,1,0,0">
                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Button TabIndex="5" Style="{StaticResource BtnOkStyle}" Command="{Binding Save}" CommandParameter="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}">确定</Button>
                        </StackPanel>
                    </Border>
                </Grid>

            </TabItem>




        </TabControl>
    </Grid>



</Window>