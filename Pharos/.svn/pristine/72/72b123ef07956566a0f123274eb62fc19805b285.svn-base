@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_TreeManagerLayout.cshtml";
    ViewData.OpBtnInfo(new OpBtnInfo(addText: "新增人员", delText: "删除人员", editText: "修改人员",hideDel:true));
}

@section search{
    <table class="table-toolbar">
        <tr>
            <td class="label-toolbar">
                <label>角色：</label>
            </td>
            <td class="input-toolbar">
                <select class="easyui-combobox" name="status" data-options="editable:false,width:80"></select>
            </td>
            <td class="label-toolbar">
                <label>状态：</label>
            </td>
            <td class="input-toolbar">
                <select class="easyui-combobox" name="status" data-options="editable:false,width:80">
                    <option value="">全部</option>
                    <option value="1">正常</option>
                    <option value="2">暂停</option>
                    <option value="3">注销</option>
                </select>
            </td>
            <td class="label-toolbar">
                <label>关键字：</label>
            </td>
            <td class="input-toolbar">
                <select class="easyui-combobox" name="searchField" data-options="editable:false,width:100">
                    <option value="1">按姓名</option>
                    <option value="2">按工号</option>
                    <option value="3">按帐号</option>
                </select>&nbsp;
            </td>
            <td class="input-toolbar">
                <input type="text" class="easyui-textbox" data-options="prompt:'请输入查询条件...'" />
            </td>
        </tr>
    </table>
}
@section toolbar
{
    <a href="#" class="easyui-linkbutton cus1 linkbtn" data-options="iconCls:'icon-usable'" onclick="setState(2)">设为暂停</a>
    <a href="#" class="easyui-linkbutton cus1 linkbtn" data-options="iconCls:'icon-usable'" onclick="setState(1)">设为正常</a>
    <a href="#" class="easyui-linkbutton cus1 linkbtn" data-options="iconCls:'icon-usable'" onclick="setState(3)">设为注销</a>
}

<script type="text/javascript">
    pharos.manager.columns = [[
        { field: 'Id', checkbox: true },
        { field: 'UserCode', title: '员工编号', width: 80 },
        { field: 'FullName', title: '员工姓名', width: 100 },
        { field: 'LoginName', title: '后台账号', width: 80 },
        { field: 'DeptTitle', title: '部门', width: 80 },
        { field: 'PositionTitle', title: '职位', width: 70 },
        { field: '', title: '角色组', width: 140 },
        { field: 'CreateDT', title: '创建时间', width: 140 },
        { field: 'LoginDT', title: '最近登录时间', width: 140 },
        { field: 'Status', title: '状态', width: 60, formatter: function (value, row, index) { return value == 1 ? "正常" : value == 2 ? "暂停" : "注销"; } }
    ]];
    pharos.manager.addItem = function () {
        this.Id = "";
        openDialog600(this.addText, this.editurlNocache());
    }
    pharos.manager.editItem = function (id) {
        this.Id = id;
        openDialog600(this.editText, this.editurlNocache());
    }
    function setState(state) {
        var rows = pharos.manager.selectItems();
        if (!rows) return;
        if (rows[0].Status == state) {
            $.messager.alert("提示", "请选择不同状态");
            return;
        }
        $.ajax({
            type: 'post',
            data: { id: rows[0].Id, t: Math.random(), mode: state },
            url: "@Url.Action("SetState")",
            success: function (data) {
                pharos.manager.gridReload();
            }, error: function (data) {
                $.messager.alert("提示", "修改状态失败！", "info");
            }
        });
    }
</script>