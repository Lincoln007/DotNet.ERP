using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Web;
using System.Web.Http;

namespace Pharos.Api.Retailing.Controllers
{
    [RoutePrefix("api")]
    public class UploadImageController : ApiController
    {
        [HttpPost]
        [Route("UploadAppIcon")]
        public void UploadAppIcon()
        {
            var type = HttpContext.Current.Request["type"];
            var data= Request.Content.ReadAsByteArrayAsync().Result;
            string path="",path2="";
            if (type == "960")
                path = GetImgsController.GetImagePath("ios960");
            else
            {
                path = GetImgsController.GetImagePath("ios640");
                path2 = GetImgsController.GetImagePath("android640");
            }
            var filename = Path.Combine(path, "login_sysLogo.png");
            using (var fs = new FileStream(filename, FileMode.Create))
            {
                BinaryWriter bw = new BinaryWriter(fs);
                bw.Write(data);
                bw.Close();
                fs.Close();
            }
            if(!string.IsNullOrEmpty(path2))
            {
                File.Copy(filename, Path.Combine(path2, "login_sysLogo.png"), true);
            }
        }
    }
}