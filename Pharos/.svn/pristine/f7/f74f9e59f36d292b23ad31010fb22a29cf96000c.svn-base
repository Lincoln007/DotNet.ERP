<Window xmlns:Retailing="clr-namespace:Pharos.POS.Retailing"
        xmlns:rules="clr-namespace:Pharos.POS.Retailing.Models.DataRules"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="d"  x:Class="Pharos.POS.Retailing.ChildPages.ChaJiaGe"
        WindowState="Normal" WindowStyle="None" Style="{DynamicResource SkinWindowStyle}"
        AllowsTransparency="True" Icon="..\Images\ZhengDanJieSuan\price2.png"  FontFamily="/Pharos.POS.Retailing;component/Fonts/#Microsoft YaHei" 
        Background="Transparent" BorderBrush="Transparent"
        Title="查价格" Height="600" Width="1100">
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="..\Styles\ChaJiaGeStyle.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>

	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="70"/>
			<RowDefinition Height="*"/>
		</Grid.RowDefinitions>
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="200"/>
			<ColumnDefinition Width="*"/>
		</Grid.ColumnDefinitions>

		<StackPanel Grid.Column="0" Grid.Row="0" Grid.RowSpan="2">
			<TreeView Background="White" BorderBrush="Transparent" BorderThickness="0" Height="515" ItemsSource="{Binding CategoryTree}" ItemContainerStyle="{DynamicResource TreeViewItemStyle}" ItemTemplate="{StaticResource TreeItemTemplate}"/>
		</StackPanel>



		<Grid Grid.Row="0" Grid.Column="1">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="110"/>
				<ColumnDefinition Width="150"/>
				<ColumnDefinition Width="50"/>
				<ColumnDefinition Width="150"/>
				<ColumnDefinition Width="170"/>
				<ColumnDefinition Width="*"/>
			</Grid.ColumnDefinitions>
			<TextBlock Grid.Column="0" TextAlignment="Right" FontSize="14"><Run Text="系统售价(元)："/></TextBlock>
            <TextBox TabIndex="1" Style="{StaticResource txtBaseInput}" Grid.Column="1"  PreviewGotKeyboardFocus="TextBox_PreviewGotKeyboardFocus" MouseEnter="TextBox_MouseEnter" Margin="0,18,0,17">
                <Binding Path="Form" StringFormat="{}{0:N}"   UpdateSourceTrigger="LostFocus" ValidatesOnExceptions="True" ValidatesOnDataErrors="True">
                    <Binding.ValidationRules>
                        <rules:MoneyVerifyRule MinValue="0" MinErrorInfo="售价不能为负数！" NaNErrorInfo="请输入正确的售价！"/>
                    </Binding.ValidationRules>
                </Binding>
            </TextBox>
            <TextBlock Grid.Column="2" FontSize="14"><Run Text="至"/></TextBlock>
            <TextBox TabIndex="2" Style="{StaticResource txtBaseInput}" Grid.Column="3" PreviewGotKeyboardFocus="TextBox_PreviewGotKeyboardFocus"  MouseEnter="TextBox_MouseEnter">
                <Binding Path="To" StringFormat="{}{0:N}"    UpdateSourceTrigger="LostFocus" ValidatesOnExceptions="True" ValidatesOnDataErrors="True">
					<Binding.ValidationRules>
						<rules:MoneyVerifyRule MinValue="0" MinErrorInfo="售价不能为负数！" NaNErrorInfo="请输入正确的售价！"/>
					</Binding.ValidationRules>
				</Binding>
			</TextBox>
			<Button TabIndex="3" Grid.Column="4" Command="{Binding Search}"  CommandParameter="{Binding RelativeSource={RelativeSource AncestorType={x:Type Window}, Mode=FindAncestor}}" Style="{StaticResource BtnSearchStyle}" Content="查询"/>
		</Grid>
		<StackPanel Grid.Row="1"  Grid.Column="1">
            <DataGrid Name="DataView" PreviewKeyDown="DataView_PreviewKeyDown"  ItemsSource="{Binding Products}" BorderThickness="1" BorderBrush="#BCB4BB"  Height="450" Margin="10,0"  VerticalGridLinesBrush="Transparent" HorizontalGridLinesBrush="#D6DBE9" CanUserSortColumns="False" CanUserDeleteRows="True" CanUserAddRows="False" CanUserReorderColumns="False" HeadersVisibility="Column"  AutoGenerateColumns="False">
				<DataGrid.Columns>
					<DataGridTextColumn Binding="{Binding Barcode}" IsReadOnly="True" Header="条码" Width="200">
						<DataGridTextColumn.ElementStyle>
							<Style TargetType="{x:Type TextBlock}">
								<Setter Property="TextWrapping" Value="Wrap"/>
								<Setter Property="Height" Value="auto"/>
							</Style>
						</DataGridTextColumn.ElementStyle>
					</DataGridTextColumn>
					<DataGridTextColumn Binding="{Binding ProductName}" IsReadOnly="True" Header="品名" Width="200*">
						<DataGridTextColumn.ElementStyle>
							<Style TargetType="{x:Type TextBlock}">
								<Setter Property="TextWrapping" Value="Wrap"/>
								<Setter Property="Height" Value="auto"/>
							</Style>
						</DataGridTextColumn.ElementStyle>
					</DataGridTextColumn>


					<DataGridTextColumn Binding="{Binding Unit}" IsReadOnly="True" Header="单位" Width="50">
						<DataGridTextColumn.ElementStyle>
							<Style TargetType="{x:Type TextBlock}">
								<Setter Property="TextWrapping" Value="Wrap"/>
								<Setter Property="Height" Value="auto"/>
							</Style>
						</DataGridTextColumn.ElementStyle>
					</DataGridTextColumn>
					<DataGridTextColumn Binding="{Binding SysPrice, StringFormat=\{0:C\}}" IsReadOnly="True" Header="系统售价" Width="150"/>
                    <DataGridTemplateColumn CanUserSort="False" IsReadOnly="True" Width="80" Header="">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <Button Style="{StaticResource BtnBase}" Command="{Binding AddCommand}" CommandParameter="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" BorderBrush="#93C34D" Width="70" Foreground="#93C34D" Height="35"  BorderThickness="2" FontSize="14" Background="#FFFFFF">加入</Button>
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
				</DataGrid.Columns>
			</DataGrid>
		</StackPanel>
	</Grid>
</Window>

