<Window xmlns:Retailing="clr-namespace:Pharos.POS.Retailing"  x:Class="Pharos.POS.Retailing.ChildPages.ChaKuCun"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:rules="clr-namespace:Pharos.POS.Retailing.Models.DataRules"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        WindowState="Normal" WindowStyle="None" Icon="..\Images\search.png"  Style="{DynamicResource SkinWindowStyle}"
        AllowsTransparency="True"  WindowStartupLocation="CenterScreen"
        Background="Transparent" BorderBrush="Transparent"  FontFamily="/Pharos.POS.Retailing;component/Fonts/#Microsoft YaHei" 
        Name="mainWindow" Title="查库存" Height="600" Width="1024">
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="..\Styles\ChaKuCunStyle.xaml"></ResourceDictionary>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="50"></RowDefinition>
            <RowDefinition Height="*"></RowDefinition>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="200"></ColumnDefinition>
            <ColumnDefinition Width="*"></ColumnDefinition>
        </Grid.ColumnDefinitions>
        <Grid Grid.Row="0" Grid.Column="1" VerticalAlignment="Center">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="90"></ColumnDefinition>
                <ColumnDefinition Width="130"></ColumnDefinition>
                <ColumnDefinition Width="60"></ColumnDefinition>
                <ColumnDefinition Width="130"></ColumnDefinition>

                <ColumnDefinition Width="*"></ColumnDefinition>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="50"></RowDefinition>
            </Grid.RowDefinitions>

            <TextBlock Grid.Column="0">条码/货号：</TextBlock>
            <TextBox TabIndex="0" Width="130" Style="{StaticResource txtBaseInput}" Grid.Column="1"  PreviewGotKeyboardFocus="TextBox_PreviewGotKeyboardFocus">
                <TextBox.Text>
                    <Binding Mode="TwoWay" Path="Code" ValidatesOnExceptions="True" NotifyOnValidationError="True"  UpdateSourceTrigger="LostFocus" ValidatesOnDataErrors="True">
                        <Binding.ValidationRules>
                            <rules:GoodsBarCodeRules></rules:GoodsBarCodeRules>
                        </Binding.ValidationRules>
                    </Binding>
                </TextBox.Text>
            </TextBox>

            <TextBlock Grid.Column="2">品名：</TextBlock>
            <TextBox TabIndex="1"  Width="130" Style="{StaticResource txtBaseInput}" Grid.Column="3"  PreviewGotKeyboardFocus="TextBox_PreviewGotKeyboardFocus">
                <TextBox.Text>
                    <Binding Mode="TwoWay" Path="GoodsName" ValidatesOnExceptions="True" NotifyOnValidationError="True"  UpdateSourceTrigger="LostFocus" ValidatesOnDataErrors="True">
                    </Binding>
                </TextBox.Text>
            </TextBox>
            <Button Grid.Column="6" Style="{StaticResource BtnSearchStyle}" Command="{Binding Search}"  CommandParameter="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" >查询</Button>
        </Grid>
        <StackPanel Grid.Row="1" Grid.Column="1">
            <DataGrid Name="DataView" PreviewKeyDown="DataView_PreviewKeyDown" ItemsSource="{Binding Commodities,Mode=OneWay}" BorderThickness="1" BorderBrush="#BCB4BB"  Height="460" Margin="10" VerticalGridLinesBrush="Transparent" HorizontalGridLinesBrush="#D6DBE9" CanUserSortColumns="False" CanUserDeleteRows="True" CanUserAddRows="False" CanUserReorderColumns="False" HeadersVisibility="Column"  AutoGenerateColumns="False">
                <DataGrid.Columns>
                    <DataGridTextColumn Binding="{Binding Barcode}" IsReadOnly="True" Header="条码" Width="190*">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="TextWrapping" Value="Wrap"/>
                                <Setter Property="Height" Value="auto"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Binding="{Binding CategoryName}" IsReadOnly="True" Header="品类" Width="100">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="TextWrapping" Value="Wrap"/>
                                <Setter Property="Height" Value="auto"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Binding="{Binding ProductName}" IsReadOnly="True" Header="品名" Width="160*">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="TextWrapping" Value="Wrap"/>
                                <Setter Property="Height" Value="auto"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <!--<DataGridTextColumn Binding="{Binding ProductCode}" IsReadOnly="True" Header="货号" Width="120*">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="TextWrapping" Value="Wrap"/>
                                <Setter Property="Height" Value="auto"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>-->

                    <DataGridTextColumn Binding="{Binding SysPrice,StringFormat='{}{0:N}'}" IsReadOnly="True" Header="系统售价" Width="100"></DataGridTextColumn>
                    <DataGridTextColumn Binding="{Binding StockNumber}" IsReadOnly="True" Header="库存量" Width="100"></DataGridTextColumn>
                    <DataGridTemplateColumn CanUserSort="False" IsReadOnly="True" Width="80" Header="">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <Button Style="{StaticResource BtnBase}" Visibility="{Binding VisibilityButton,Mode=OneWay}" Command="{Binding AddCommand}" CommandParameter="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" BorderBrush="#93C34D" Width="70" Foreground="#93C34D" Height="35"  BorderThickness="2" FontSize="14" Background="#FFFFFF">加入</Button>
                                    <Button Style="{StaticResource BtnBase}" Visibility="{Binding VisibilityDisableButton,Mode=OneWay}" BorderBrush="#D6DBE9" Width="70" Foreground="#D6DBE9" Height="35"  BorderThickness="2" FontSize="14" Background="#FFFFFF">加入</Button>
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </StackPanel>
        <StackPanel Grid.Column="0" Grid.Row="0" Grid.RowSpan="2">
            <TreeView Background="White" BorderBrush="Transparent" BorderThickness="0" Height="515" ItemsSource="{Binding CategoryTree}" ItemContainerStyle="{DynamicResource TreeViewItemStyle}" ItemTemplate="{StaticResource TreeItemTemplate}"></TreeView>
        </StackPanel>
    </Grid>
</Window>

