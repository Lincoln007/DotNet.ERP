using Pharos.Logic.ApiData.Pos.ValueObject;
using Pharos.Logic.ApiData.Pos.Extensions;
using Pharos.Logic.BLL;
using Pharos.Logic.DAL;
using Pharos.Logic.Entity;
using System;
using System.Collections.Generic;
using System.Data.SqlClient;
using System.Linq;
using System.Text;

namespace Pharos.Logic.ApiData.Pos.Services
{
    public class WarehouseService : BaseGeneralService<Warehouse, EFDbContext>
    {
        public static PageResult<InventoryResult> CheckedInventory(string storeId, int tonken, IEnumerable<int> categorySns, string keyword, int pageSize, int pageIndex)
        {
            try
            {
                string categorySnsStr = null;
                if (categorySns != null)
                    categorySnsStr = string.Join(",", categorySns.Select(o => o.ToString()));
                var result = CurrentRepository._context.Database.SqlQuery<InventoryResult>("exec CheckedInventory @p0,@p1,@p2,@p3", categorySnsStr, storeId, keyword, tonken).ToPageList(pageSize, pageIndex);
                return result;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public static PageResult<InventoryResult> CheckedPrice(string storeId, int token, IEnumerable<int> categorySns, decimal from, decimal to, int pageSize, int pageIndex)
        {
            try
            {
                string categorySnsStr = null;
                if (categorySns != null)
                    categorySnsStr = string.Join(",", categorySns.Select(o => o.ToString()));
                var result = CurrentRepository._context.Database.SqlQuery<InventoryResult>("exec CheckedPrice @p0,@p1,@p2,@p3,@p4", categorySnsStr, storeId, from, to, token).ToPageList(pageSize, pageIndex);
                return result;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        public static IEnumerable<InventoryResult> CheckedPrice(string storeId, int token, IEnumerable<int> categorySns, decimal from, decimal to)
        {
            try
            {
                string categorySnsStr = null;
                if (categorySns != null)
                    categorySnsStr = string.Join(",", categorySns.Select(o => o.ToString()));
                var result = CurrentRepository._context.Database.SqlQuery<InventoryResult>("exec CheckedPrice @p0,@p1,@p2,@p3,@p4", categorySnsStr, storeId, from, to, token).ToList();
                return result;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
    }
}
