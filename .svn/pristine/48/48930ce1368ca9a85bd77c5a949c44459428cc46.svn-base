@{
    ViewBag.Title = Pharos.Sys.SysConstPool.Page_Title;
    Layout = "~/Views/Shared/_ManagerLayout.cshtml";
    ViewData.OpBtnInfo(new OpBtnInfo(hideAdd: true, hideEdit: true, hideDel: true));
}

@section search{
    <table class="table-toolbar">
        <tr>
            <td class="label-toolbar">
                <label>日期：</label>
            </td>
            <td class="input-toolbar">
                <input name="date" value="@DateTime.Now.ToString("yyyy-MM-dd")" class="datacontrol Wdate" onclick="WdatePicker({dateFmt: 'yyyy-MM-dd'})" />
            </td>
            <td class="label-toolbar">
                <label>门店：</label>
            </td>
            <td class="input-toolbar">
                @*@Html.DropDownList("store", ViewBag.stores as List<SelectListItem>, new { @class = "easyui-combobox datecontrol", data_options = (CurrentUser.IsStore ? "readonly:true," : "") + "editable:false,panelHeight:'auto',panelMaxHeight:200" })*@
                @Form.Combobox("store", ViewBag.stores as List<SelectListItem>, dataOptions: (CurrentUser.IsStore ? "readonly:true," : "") + "editable:false,panelMaxHeight:200")
            </td>
            <td class="label-toolbar">
                <label>收银员：</label>
            </td>
            <td class="input-toolbar">
                @Form.Combobox("cashier", ViewBag.cashiers as List<SelectListItem>, dataOptions: "editable:false,panelHeight:'auto',panelMaxHeight:200")
            </td>
            <td class="label-toolbar">
                <label>导购员：</label>
            </td>
            <td class="input-toolbar">
                @Form.Combobox("saler", ViewBag.salers as List<SelectListItem>, dataOptions: "editable:false,panelHeight:'auto',panelMaxHeight:200")
            </td>
        </tr>
    </table>
}
@section toolbar
{
    <a href="#" class="easyui-linkbutton cus1 linkbtn" data-options="iconCls:'icon-export'" onclick="Export()">导出Excel</a>
}
<script type="text/javascript">
    pharos.manager.geturl = '@Url.Action("QueryOrderSaleDetailDayPageList")';
    pharos.manager.pagination = true;
    pharos.manager.showFooter = true;
    pharos.manager.columns = [[
        { field: 'Date', title: '日结时间', width: 100 },
        { field: 'Cashier', title: '收银员', width: 150 },
        { field: 'FirstTime', title: '首笔时间', width: 150 },
        { field: 'LastTime', title: '末笔时间', width: 150 },
        { field: 'XSCount', title: '销售笔数', width: 80 },
        { field: 'XSMoney', title: '销售金额', width: 80 },
        { field: 'ZSCount', title: '赠送笔数', width: 80 },
        { field: 'ZSMoney', title: '赠送金额', width: 80 },
        { field: 'TUICount', title: '退货笔数', width: 80 },
        { field: 'TUIMoney', title: '退货金额', width: 80 },
        { field: 'HUANCount', title: '换货笔数', width: 80 },
        { field: 'HUANMoney', title: '换货金额', width: 80 },
        { field: 'MLCount', title: '抹零笔数', width: 80 },
        { field: 'MLMoney', title: '抹零金额', width: 80 }
    ]];
    @*pharos.manager.editItem = function (id, row) {
        openDialog("销售明细", "@Url.Action("SaleOrderDetail")?paysn=" + row.PaySN + "&" + $('#frmsearch').serialize(), 1000, 560, true);
    }*@
    function Export() {
        var date = $("[name='date']").val();
        if (!date) {
            $.messager.alert("提示", "请先选择日期!"); return;
        }
        window.location.href = '@Url.Action("SaleExport")?type=6&' + $('#frmsearch').serialize();
    }


</script>